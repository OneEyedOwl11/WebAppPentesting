Like TCP over HTTP. Almost

- Enable bi-directional messages between clients and servers
- allows servers to send things not explicitly requested
- free browsers from having to poll for server-side changes

Can be used for a variety of web applications: games, stock traders, stock tickers, chat rooms. etc

follows origin model
	same basis as same origin policy
scheme in [[URL's]] is ws:// or wss://
Request Headers
	connection: Upgrade
	Upgrade: websocket
	Sec-WebSocket-Version:13
	Sec-WebSocket-Key (16-byte random nonce(not but once. used to introduce variability), base64 encoded)
	Origin: http://example.com

![[Pasted image 20241003134535.png]]
![[Pasted image 20241003134607.png]]

[[HTTP]] Response Header "Sec-WebSocket-Accept" is...
1.sec-websocket-key from the request
	2.With a constant RFC-specified GUID appended
		3.SHA-1 hash\`
			4.Base64 Encode
![[Pasted image 20241003134845.png]]
This would be the recipe in [[CyberChef]]
![[Pasted image 20241003135015.png]]

Server knows it's legit because of the origin request header

Client knows that it's talking to the right server because the client provided randomness that's part of the web-socket-accept header in the response

Non-Browser Clients
- while this protocol is intended to be used by scripts in web pages, it can also be used directly by hosts (which can) send fake (origin) header fields
- Servers should therefore be careful about assuming that they are talking directly to scripts from known origins and must consider that they might be accessed in unexpected ways. In particular, a server should not trust that any input is valid
- RFC says: If the server uses input as part of SQL queries, all input text should be escaped before being passed to the SQL server, lest the server be susceptible to [[SQL Injection]] !!!BUT IT IS WRONG

Not different enough from HTTP to be "hard"
Just need the right tools

After [[LAB 14]]

Showing yourself a banner may seem unimpressive but remember that Web Sockets go both ways

Recent test: Password change by Web Socket
	Include "Web Socket ID" in the message (red flag)
	include username in the message (red flag)
Steps in this lab: same as for stealing accounts in real app

WebSocket client authentication:
This protocol doesn't prescribe any particular way that servers can authenticate clients during the WebSocket handshake. The WebSocket server can use any client authentication mechanism available to a generic [[HTTP]] server, such as cookies, [[HTTP]] Authentication, or TLS Authentication, did we see any cookies on that hoe?